"function"!=typeof Object.create&&function(){var o=function(){};Object.create=function(t){if(1<arguments.length)throw Error("Second argument not supported");if(null===t)throw Error("Cannot set a null [[Prototype]]");if("object"!=typeof t)throw TypeError("Argument must be an object");return o.prototype=t,new o}}(),CKEDITOR.plugins.add("toolbarconfiguratorarea",{afterInit:function(e){e.addMode("wysiwyg",function(t){var o=CKEDITOR.dom.element.createFromHtml('<div class="cke_wysiwyg_div cke_reset" hidefocus="true"></div>');e.ui.space("contents").append(o),(o=e.editable(o)).detach=CKEDITOR.tools.override(o.detach,function(t){return function(){t.apply(this,arguments),this.remove()}}),e.setData(e.getData(1),t),e.fire("contentDom")}),e.dataProcessor.toHtml=function(t){return t},e.dataProcessor.toDataFormat=function(t){return t}}}),Object.keys||(Object.keys=function(){var n=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),r="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),a=r.length;return function(t){if("object"!=typeof t&&("function"!=typeof t||null===t))throw new TypeError("Object.keys called on non-object");var o,e=[];for(o in t)n.call(t,o)&&e.push(o);if(i)for(o=0;o<a;o++)n.call(t,r[o])&&e.push(r[o]);return e}}()),function(){function r(t,o){this.cfg=o||{},this.hidden=!1,this.editorId=t,this.fullToolbarEditor=new ToolbarConfigurator.FullToolbarEditor,this.actualConfig=this.originalConfig=this.mainContainer=null,this.isEditableVisible=this.waitForReady=!1,this.toolbarContainer=null,this.toolbarButtons=[]}(ToolbarConfigurator.AbstractToolbarModifier=r).prototype.setConfig=function(t){this._onInit(void 0,t,!0)},r.prototype.init=function(t){var o=this;if(this.mainContainer=new CKEDITOR.dom.element("div"),null!==this.fullToolbarEditor.editorInstance)throw"Only one instance of ToolbarModifier is allowed";return this.editorInstance||this._createEditor(!1),this.editorInstance.once("loaded",function(){o.fullToolbarEditor.init(function(){o._onInit(t),"function"==typeof o.onRefresh&&o.onRefresh()},o.editorInstance.config)}),this.mainContainer},r.prototype._onInit=function(t,o){if(this.originalConfig=this.editorInstance.config,this.actualConfig=o?JSON.parse(o):JSON.parse(JSON.stringify(this.originalConfig)),!this.actualConfig.toolbarGroups&&!this.actualConfig.toolbar){for(var e=this.actualConfig,n=this.editorInstance.toolbar,i=[],r=n.length,a=0;a<r;a++){var s=n[a];"string"==typeof s?i.push(s):i.push({name:s.name,groups:s.groups?s.groups.slice():[]})}e.toolbarGroups=i}"function"==typeof t&&t(this.mainContainer)},r.prototype._createModifier=function(){return this.mainContainer.addClass("unselectable"),this.modifyContainer&&this.modifyContainer.remove(),this.modifyContainer=new CKEDITOR.dom.element("div"),this.modifyContainer.addClass("toolbarModifier"),this.mainContainer.append(this.modifyContainer),this.mainContainer},r.prototype.getEditableArea=function(){return this.editorInstance.container.findOne("#"+this.editorInstance.id+"_contents")},r.prototype._hideEditable=function(){var t=this.getEditableArea();this.isEditableVisible=!1,this.lastEditableAreaHeight=t.getStyle("height"),t.setStyle("height","0")},r.prototype._showEditable=function(){this.isEditableVisible=!0,this.getEditableArea().setStyle("height",this.lastEditableAreaHeight||"auto")},r.prototype._toggleEditable=function(){this.isEditableVisible?this._hideEditable():this._showEditable()},r.prototype._refreshEditor=function(){function t(){o.editorInstance.destroy(),o._createEditor(!0,o.getActualConfig()),o.waitForReady=!1}var o=this,e=this.editorInstance.status;this.waitForReady||("unloaded"==e||"loaded"==e?(this.waitForReady=!0,this.editorInstance.once("instanceReady",function(){t()},this)):t())},r.prototype._createEditor=function(e,o){function n(){}var i=this;this.editorInstance=CKEDITOR.replace(this.editorId),this.editorInstance.on("configLoaded",function(){var t=i.editorInstance.config;o&&CKEDITOR.tools.extend(t,o,!0),r.extendPluginsConfig(t)}),this.editorInstance.on("uiSpace",function(t){"top"!=t.data.space&&t.stop()},null,null,-999),this.editorInstance.once("loaded",function(){var t,o=i.editorInstance.ui.instances;for(t in o)o[t]&&(o[t].click=n,o[t].onClick=n);i.isEditableVisible||i._hideEditable(),i.currentActive&&i.currentActive.name&&i._highlightGroup(i.currentActive.name),i.hidden?i.hideUI():i.showUI(),e&&"function"==typeof i.onRefresh&&i.onRefresh()})},r.prototype.getActualConfig=function(){return JSON.parse(JSON.stringify(this.actualConfig))},r.prototype._createToolbar=function(){if(this.toolbarButtons.length){this.toolbarContainer=new CKEDITOR.dom.element("div"),this.toolbarContainer.addClass("toolbar");for(var t=this.toolbarButtons.length,o=0;o<t;o+=1)this._createToolbarBtn(this.toolbarButtons[o])}},r.prototype._createToolbarBtn=function(t){var o=ToolbarConfigurator.FullToolbarEditor.createButton("string"==typeof t.text?t.text:t.text.inactive,t.cssClass);return this.toolbarContainer.append(o),o.data("group",t.group),o.addClass(t.position),o.on("click",function(){t.clickCallback.call(this,o,t)},this),o},r.prototype._fixGroups=function(t){for(var o=(t=t.toolbarGroups||[]).length,e=0;e<o;e+=1){var n=t[e];"/"==n?((n=t[e]={}).type="separator",n.name="separator"+CKEDITOR.tools.getNextNumber()):(n.groups=n.groups||[],-1==CKEDITOR.tools.indexOf(n.groups,n.name)&&(this.editorInstance.ui.addToolbarGroup(n.name,n.groups[n.groups.length-1],n.name),n.groups.push(n.name)),this._fixSubgroups(n))}},r.prototype._fixSubgroups=function(t){for(var o=(t=t.groups).length,e=0;e<o;e+=1){var n=t[e];t[e]={name:n,totalBtns:ToolbarConfigurator.ToolbarModifier.getTotalSubGroupButtonsNumber(n,this.fullToolbarEditor)}}},r.stringifyJSONintoOneLine=function(t,o){o=o||{};var e=(e=JSON.stringify(t,null,"")).replace(/\n/g,"");return o.addSpaces&&(e=(e=e.replace(/(\{|:|,|\[|\])/g,function(t){return t+" "})).replace(/(\])/g,function(t){return" "+t})),o.noQuotesOnKey&&(e=e.replace(/"(\w*)":/g,function(t,o){return o+":"})),o.singleQuotes&&(e=e.replace(/\"/g,"'")),e},r.prototype.hideUI=function(){this.hidden=!0,this.mainContainer.hide(),this.editorInstance.container&&this.editorInstance.container.hide()},r.prototype.showUI=function(){this.hidden=!1,this.mainContainer.show(),this.editorInstance.container&&this.editorInstance.container.show()},r.extendPluginsConfig=function(t){var o=t.extraPlugins;t.extraPlugins=(o?o+",":"")+"toolbarconfiguratorarea"}}();